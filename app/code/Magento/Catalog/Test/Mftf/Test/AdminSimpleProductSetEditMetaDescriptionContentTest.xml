<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * Copyright 2022 Adobe
 * All Rights Reserved.
 */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="AdminSimpleProductSetEditMetaDescriptionContentTest">
        <annotations>
            <features value="Catalog"/>
            <stories value="Create/edit simple product"/>
            <title value="Admin should be able to set/edit product Content when editing a simple product. Meta description should be autogenerated."/>
            <description value="Admin should be able to set/edit product Content when editing a simple product"/>
            <severity value="MINOR"/>
            <testCaseId value="AC-6971"/>
            <group value="Catalog"/>
            <group value="WYSIWYGDisabled"/>
        </annotations>
        <before>
            <!--Admin Login-->
            <actionGroup stepKey="loginToAdminPanel" ref="AdminLoginActionGroup"/>
            <actionGroup ref="DisabledWYSIWYGActionGroup" stepKey="disableWYSIWYG"/>
        </before>
        <after>
            <!--Admin Logout-->
            <actionGroup ref="AdminLogoutActionGroup" stepKey="logout"/>
        </after>

        <!-- Create product -->
        <actionGroup ref="AdminOpenProductIndexPageActionGroup" stepKey="navigateToProductIndex"/>
        <actionGroup ref="GoToCreateProductPageActionGroup" stepKey="goToCreateProduct">
            <argument name="product" value="SimpleProduct"/>
        </actionGroup>
        <actionGroup ref="FillMainProductFormNoWeightActionGroup" stepKey="fillProductForm">
            <argument name="product" value="SimpleProduct"/>
        </actionGroup>

        <!--Add content-->
        <!--A generic scroll scrolls past this element, in doing this it fails to execute certain actions on the element and others below it. By scrolling slightly above it resolves this issue.-->
        <comment userInput="Comment is added to preserve the step key for backward compatibility" stepKey="scrollTo"/>
        <actionGroup ref="AdminOpenContentSectionOnProductPageActionGroup" stepKey="openDescriptionDropDown"/>
        <actionGroup ref="AdminFillInProductDescriptionActionGroup" stepKey="fillLongDescription">
            <argument name="description" value="&lt;style&gt;#html-body [data-pb-style=A463JYO]&lt;/style&gt;&lt;div data-content-type='block' data-appearance='default' data-element='main' data-pb-style='B1D1SCO'&gt;{{widget type='Magento\Cms\Block\Widget\Block' template='widget/static_block/default.phtml' block_id='1' type_name='CMS Static Block'}}&lt;/div&gt;&lt;p&gt;HTML description&lt;/p&gt;"/>
        </actionGroup>
        <actionGroup ref="AdminFillProductNameOnProductFormActionGroup" stepKey="fillProductName">
            <argument name="productName" value="simple"/>
        </actionGroup>

        <!--Checking SEO content admin-->
        <actionGroup ref="AssertMetaDescriptionInProductEditFormActionGroup" stepKey="seeProductMetaDescription">
            <argument name="productMetaDescription" value="simple HTML description"/>
        </actionGroup>
    </test>
</tests>
